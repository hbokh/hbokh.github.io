<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Hands-on: WordPress en MySQL op Docker | ExampleSite</title><meta name=keywords content="docker,dutch,meetup"><meta name=description content="A manual (in Dutch) written for the local Docker Grunn Meetup, to become familiar with Docker & Compose by setting up a WordPress-blog."><meta name=author content="Me"><link rel=canonical href=https://examplesite.com/post/meetup2015/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://examplesite.com/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Hands-on: WordPress en MySQL op Docker"><meta property="og:description" content="A manual (in Dutch) written for the local Docker Grunn Meetup, to become familiar with Docker & Compose by setting up a WordPress-blog."><meta property="og:type" content="article"><meta property="og:url" content="https://examplesite.com/post/meetup2015/"><meta property="og:image" content="https://examplesite.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="post"><meta property="article:published_time" content="2015-05-23T09:12:15+00:00"><meta property="article:modified_time" content="2015-05-23T09:12:15+00:00"><meta property="og:site_name" content="ExampleSite"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://examplesite.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Hands-on: WordPress en MySQL op Docker"><meta name=twitter:description content="A manual (in Dutch) written for the local Docker Grunn Meetup, to become familiar with Docker & Compose by setting up a WordPress-blog."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://examplesite.com/post/"},{"@type":"ListItem","position":2,"name":"Hands-on: WordPress en MySQL op Docker","item":"https://examplesite.com/post/meetup2015/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Hands-on: WordPress en MySQL op Docker","name":"Hands-on: WordPress en MySQL op Docker","description":"A manual (in Dutch) written for the local Docker Grunn Meetup, to become familiar with Docker \u0026amp; Compose by setting up a WordPress-blog.\n","keywords":["docker","dutch","meetup"],"articleBody":"A manual (in Dutch) written for the local Docker Grunn Meetup, to become familiar with Docker \u0026 Compose by setting up a WordPress-blog.\nImage credits: Blake Thornberry - Flickr\nVooraf installeren! Zorg dat je op zijn minst de beschikking hebt over\neen werkende installatie van Docker (Linux) of boot2docker (OS X / Windows). De installatie staat hier beschreven.\nboot2docker is op zijn beurt weer afhankelijk van VirtualBox.\nReferentie: Guide to Docker on OS X\nOf Docker juist werkt, kan je vervolgens testen met docker run --rm hello-world.\nDocker Compose (link): De installatie werkt zo:\n$ curl -L https://github.com/docker/compose/releases/download/1.2.0/docker-compose-`uname -s`-`uname -m` \u003e /usr/local/bin/docker-compose $ chmod +x /usr/local/bin/docker-compose WordPress \u0026 MySQL dual container setup Docker images downloaden Twee methodes zijn voorhanden.\nOm bandbreedte te besparen heeft de eerste methode de voorkeur!\n1. Tarball van saved images downloaden en inladen\nDit zijn images uit de officiele Docker Registry, saved to a tar archive, gzipped en op een host geplaatst, die relatief dichtbij is.\n$ wget https://example.com/mysql.tar.gz (size: 142 MB) $ wget https://example.com/wordpress.tar.gz (size: 163 MB) Importeer deze images:\n$ docker load \u003c mysql.tar.gz $ docker load \u003c wordpress.tar.gz 2. Pull de images direct uit de officiele Docker Registry\n$ docker pull mysql (size: 282.9 MB) $ docker pull wordpress (size: 460.3 MB) Controleer welke images er nu lokaal beschikbaar zijn:\n$ docker images REPOSITORY TAG IMAGE ID CREATED VIRTUAL SIZE wordpress latest 5ff368875b77 4 days ago 460.3 MB mysql latest 56f320bd6adc 3 weeks ago 282.9 MB “Met de hand” Als eerste start je een MySQL-container op basis van het mysql:latest-image.\nWe gebruiken “p4ssw0rd” als root password en geven dat met “-e” mee als omgevings-variabele aan de container:\n$ docker run --name some-mysql -e MYSQL_ROOT_PASSWORD=p4ssw0rd -d mysql\nVervolgens start je een WordPress-container.\nDeze geef je een link naar de MySQL-container en laat je poort 80 in de container forwarden naar poort 8080 op je Docker-host:\n$ docker run --name some-wordpress --link some-mysql:mysql -p 8080:80 -d wordpress\nThat was quick!\nGa in een webbrowser naar\nhttp://localhost:8080/ (Linux) http://192.168.59.103:8080/ (boot2docker)\nen configureer WordPress verder af. Onder de motorkap [1] Wat draait er nu?\n$ docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 5c2537c15ba9 wordpress:latest \"/entrypoint.sh apac About an hour ago Up About an hour 0.0.0.0:8080-\u003e80/tcp some-wordpress 11ddc1271814 mysql:latest \"/entrypoint.sh mysq About an hour ago Up About an hour 3306/tcp some-mysql Om bijvoorbeeld IN je MySQL-container te checken wat er in de database staat, kan je met docker exec -ti een shell opstarten en in die container commandos uitvoeren:\n$ docker exec -ti some-mysql bash root@11ddc1271814:/# mysql -u root -p Enter password: p4ssw0rd Welcome to the MySQL monitor. Commands end with ; or \\g. Your MySQL connection id is 15 Server version: 5.6.24 MySQL Community Server (GPL) Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved. Oracle is a registered trademark of Oracle Corporation and/or its affiliates. Other names may be trademarks of their respective owners. Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement. mysql\u003e show databases; +--------------------+ | Database | +--------------------+ | information_schema | | mysql | | performance_schema | | wordpress | +--------------------+ 4 rows in set (0.00 sec) mysql\u003e use wordpress; Reading table information for completion of table and column names You can turn off this feature to get a quicker startup with -A Database changed mysql\u003e show tables; +-----------------------+ | Tables_in_wordpress | +-----------------------+ | wp_commentmeta | | wp_comments | | wp_links | | wp_options | | wp_postmeta | | wp_posts | | wp_term_relationships | | wp_term_taxonomy | | wp_terms | | wp_usermeta | | wp_users | +-----------------------+ 11 rows in set (0.00 sec) mysql\u003e exit Bye root@11ddc1271814:/# exit Opruimen Het commando docker kill is minder netjes dan docker stop, maar sneller als je toch besloten hebt de containers te verwijderen.\n$ docker kill 5c2537c15ba9 11ddc1271814 5c2537c15ba9 11ddc1271814 $ docker rm 5c2537c15ba9 11ddc1271814 5c2537c15ba9 11ddc1271814 $ docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES “Met docker-compose” Nu doen we hetzelfde, maar met behulp van docker-compose.\nBestand docker-compose.yml De waardes die je hierboven op de command-line hebt gegeven, kan je in docker-compose.yml combineren. Een YAML-bestand, dat er dan als volgt uit komt te zien:\ndb: image: mysql:latest environment: - MYSQL_ROOT_PASSWORD=p4ssw0rd wordpress: image: wordpress:latest links: - db:mysql ports: - \"8080:80\" Start de stack in detached mode:\n$ docker-compose up -d Creating wordpressmysql_db_1... Creating wordpressmysql_wordpress_1... Onder de motorkap [2] Wat draait er nu?\n$ docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES fe9eead88a32 wordpress:latest \"/entrypoint.sh apac 3 minutes ago Up 3 minutes 0.0.0.0:8080-\u003e80/tcp wordpressmysql_wordpress_1 6a2392af4d87 mysql:latest \"/entrypoint.sh mysq 3 minutes ago Up 3 minutes 3306/tcp wordpressmysql_db_1 $ docker-compose ps Name Command State Ports ------------------------------------------------------------------------------------------ wordpressmysql_db_1 /entrypoint.sh mysqld Up 3306/tcp wordpressmysql_wordpress_1 /entrypoint.sh apache2-for ... Up 0.0.0.0:8080-\u003e80/tcp WordPress weer opzetten middels de hierboven genoemde link naar “localhost”.\nEn na ge- / misbruik weer alles netjes achterlaten:\n$ docker-compose kill Killing wordpressmysql_wordpress_1... Killing wordpressmysql_db_1... $ docker-compose rm --force Going to remove wordpressmysql_wordpress_1, wordpressmysql_db_1 Removing wordpressmysql_db_1... Removing wordpressmysql_wordpress_1... Data volume container De data die door WordPress wordt gegenereerd (accounts, posts, etc.) kan worden opgeslagen buiten de MySQL-container in een zgn. data volume container. Die kan je op de CLI zo aanmaken:\n$ docker run -v /var/lib/mysql --name=dbdata -d mysql /bin/true\nDe container is op basis van het MySQL-image, want die hebben we immers al binnen.\nEen data volume container hoeft niet “up” te zijn om gebruikt te kunnen worden. Je ziet ’m dan ook alleen met het docker ps -a command:\n$ docker ps -a CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES c2aa204baf71 mysql:latest \"/entrypoint.sh /bin 4 minutes ago Exited (0) 4 minutes ago dbdata Om dit met docker-compose te doen, voegen we deze container toe aan de YAML-configuratie.\nHet bestand ziet er dan zo uit:\ndbdata: image: mysql volumes: - /var/lib/mysql command: - /bin/true db: image: mysql volumes_from: - dbdata environment: - MYSQL_ROOT_PASSWORD=p4ssw0rd wordpress: image: wordpress links: - db:mysql ports: - \"8080:80\" Start weer een nieuwe stack met docker-compose up -d en controleer wat er draait:\n$ docker-compose ps Name Command State Ports ------------------------------------------------------------------------------------------- wordpressmysql_db_1 /entrypoint.sh mysqld Up 3306/tcp wordpressmysql_dbdata_1 /entrypoint.sh /bin/true Exit 0 wordpressmysql_wordpress_1 /entrypoint.sh apache2-for ... Up 0.0.0.0:8080-\u003e80/tcp Het bewijs dat beide containers dezelfde “layer” gebruiken voor /var/lib/mysql kan geleverd worden middels docker inspect:\n$ docker inspect dbdata | grep \"var/lib/mysql\" | grep vfs \"/mnt/sda1/var/lib/docker/vfs/dir/9acd80fd069e82a89ac04a9141cc518ce8ee176bd7e4cc92c972dd3df50dffcc\" $ docker inspect wordpressmysql_db_1 | grep \"var/lib/mysql\" | grep vfs \"/mnt/sda1/var/lib/docker/vfs/dir/9acd80fd069e82a89ac04a9141cc518ce8ee176bd7e4cc92c972dd3df50dffcc\" In boot2docker zie je dat als volgt - in die directory staat de database-data:\ndocker@boot2docker:~$ sudo ls -altrF /mnt/sda1/var/lib/docker/vfs/dir/9acd80fd069e82a89ac04a9141cc518ce8ee176bd7e4cc92c972dd3df50dffcc/ total 176164 drwx------ 2 999 999 4096 May 14 10:59 performance_schema/ drwx------ 2 999 999 4096 May 14 10:59 mysql/ -rw-rw---- 1 999 999 50331648 May 14 10:59 ib_logfile1 -rw-rw---- 1 999 999 56 May 14 10:59 auto.cnf drwx------ 2 999 999 4096 May 14 11:02 wordpress/ drwx------ 126 root root 16384 May 14 11:07 ../ drwxr-xr-x 5 999 999 4096 May 14 11:07 ./ -rw-rw---- 1 999 999 79691776 May 14 11:07 ibdata1 -rw-rw---- 1 999 999 50331648 May 14 11:07 ib_logfile0 Backup en restore Eén manier van backuppen van de database is de volgende:\n$ docker exec -ti wordpressmysql_db_1 bash -c \\ 'mysqldump --user=root --password=\"$MYSQL_ROOT_PASSWORD\" --all-databases' \\ \u003e MySQL_full_backUp.sql Restoren kan middels volume-sharing en een gelinkte container (“db” in het onderstaande geval):\n$ docker run -ti --rm -v $(pwd):/tmp --link wordpressmysql_db_1:db mysql bash root@b2252da7520e:/# cd /tmp/ root@b2252da7520e:/tmp# ls -al ... -rw-r--r-- 1 1000 staff 1075329 May 18 14:36 MySQL_full_backUp.sql ... root@b2252da7520e:/tmp# mysql -u root -p -h $DB_PORT_3306_TCP_ADDR Enter password: mysql\u003e source MySQL_full_backUp.sql Referentie: YouTube - Docker Tutorial: Backing Up and Restoring MySQL and WordPress in Docker\nThat’s all Folks!\n","wordCount":"1253","inLanguage":"en","datePublished":"2015-05-23T09:12:15Z","dateModified":"2015-05-23T09:12:15Z","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://examplesite.com/post/meetup2015/"},"publisher":{"@type":"Organization","name":"ExampleSite","logo":{"@type":"ImageObject","url":"https://examplesite.com/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://examplesite.com/ accesskey=h title="Home (Alt + H)"><img src=https://examplesite.com/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://examplesite.com/categories/ title=categories><span>categories</span></a></li><li><a href=https://examplesite.com/tags/ title=tags><span>tags</span></a></li><li><a href=https://example.org title=example.org><span>example.org</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://examplesite.com/>Home</a>&nbsp;»&nbsp;<a href=https://examplesite.com/post/>Posts</a></div><h1 class=post-title>Hands-on: WordPress en MySQL op Docker</h1><div class=post-meta><span title='2015-05-23 09:12:15 +0000 UTC'>May 23, 2015</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;1253 words&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/post/meetup2015.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=post-content><p>A manual (in Dutch) written for the local <a href=http://www.meetup.com/DockerGrunn/>Docker Grunn Meetup</a>, to become familiar with Docker & Compose by setting up a WordPress-blog.</p><p>Image credits: Blake Thornberry - <a href=https://www.flickr.com/photos/91657289@N02/10218392744/>Flickr</a></p><h2 id=vooraf-installeren>Vooraf installeren!<a hidden class=anchor aria-hidden=true href=#vooraf-installeren>#</a></h2><p>Zorg dat je op zijn minst de beschikking hebt over</p><ul><li>een <strong>werkende</strong> installatie van <em>Docker</em> (Linux) of <em>boot2docker</em> (OS X / Windows).</li></ul><p>De installatie staat <a href=http://docs.docker.com/compose/install/#install-docker>hier</a> beschreven.<br><em>boot2docker</em> is op zijn beurt weer afhankelijk van VirtualBox.</p><p>Referentie: <a href=http://blog.tutum.co/2015/05/19/guide-to-docker-on-os-x/>Guide to Docker on OS X</a></p><p>Of Docker juist werkt, kan je vervolgens testen met <code>docker run --rm hello-world</code>.</p><ul><li><strong>Docker Compose</strong> (<a href=http://docs.docker.com/compose/install/>link</a>):</li></ul><p>De installatie werkt zo:</p><pre tabindex=0><code>$ curl -L https://github.com/docker/compose/releases/download/1.2.0/docker-compose-`uname -s`-`uname -m` &gt; /usr/local/bin/docker-compose
$ chmod +x /usr/local/bin/docker-compose
</code></pre><h2 id=wordpress--mysql-dual-container-setup>WordPress & MySQL dual container setup<a hidden class=anchor aria-hidden=true href=#wordpress--mysql-dual-container-setup>#</a></h2><h3 id=docker-images-downloaden>Docker images downloaden<a hidden class=anchor aria-hidden=true href=#docker-images-downloaden>#</a></h3><p>Twee methodes zijn voorhanden.<br>Om bandbreedte te besparen heeft de eerste methode de voorkeur!</p><p><strong>1. Tarball van saved images downloaden en inladen</strong></p><p>Dit zijn images uit de officiele Docker Registry, <em>saved to a tar archive</em>, gzipped en op een host geplaatst, die relatief dichtbij is.</p><ul><li><code>$ wget https://example.com/mysql.tar.gz</code> (size: 142 MB)</li><li><code>$ wget https://example.com/wordpress.tar.gz</code> (size: 163 MB)</li></ul><p>Importeer deze images:</p><ul><li><code>$ docker load &lt; mysql.tar.gz</code></li><li><code>$ docker load &lt; wordpress.tar.gz</code></li></ul><p><strong>2. Pull de images direct uit de officiele Docker Registry</strong></p><ul><li><code>$ docker pull mysql</code> (size: 282.9 MB)</li><li><code>$ docker pull wordpress</code> (size: 460.3 MB)</li></ul><p>Controleer welke images er nu lokaal beschikbaar zijn:</p><pre tabindex=0><code>$ docker images
REPOSITORY     TAG        IMAGE ID        CREATED        VIRTUAL SIZE
wordpress      latest     5ff368875b77    4 days ago     460.3 MB
mysql          latest     56f320bd6adc    3 weeks ago    282.9 MB
</code></pre><h3 id=met-de-hand>&ldquo;Met de hand&rdquo;<a hidden class=anchor aria-hidden=true href=#met-de-hand>#</a></h3><p>Als eerste start je een MySQL-container op basis van het <em>mysql:latest</em>-image.<br>We gebruiken &ldquo;p4ssw0rd&rdquo; als root password en geven dat met &ldquo;-e&rdquo; mee als omgevings-variabele aan de container:</p><p><code>$ docker run --name some-mysql -e MYSQL_ROOT_PASSWORD=p4ssw0rd -d mysql</code></p><p>Vervolgens start je een WordPress-container.<br>Deze geef je een <strong>link</strong> naar de MySQL-container en laat je poort 80 in de container forwarden naar poort 8080 op je Docker-host:</p><p><code>$ docker run --name some-wordpress --link some-mysql:mysql -p 8080:80 -d wordpress</code></p><p><em>That was quick!</em></p><p>Ga in een webbrowser naar</p><ul><li><code>http://localhost:8080/</code> (Linux)</li><li><code>http://192.168.59.103:8080/</code> (boot2docker)<br>en configureer WordPress verder af.</li></ul><h3 id=onder-de-motorkap-1>Onder de motorkap [1]<a hidden class=anchor aria-hidden=true href=#onder-de-motorkap-1>#</a></h3><p>Wat draait er nu?</p><pre tabindex=0><code>$ docker ps

CONTAINER ID        IMAGE               COMMAND                CREATED             STATUS              PORTS                  NAMES
5c2537c15ba9        wordpress:latest    &#34;/entrypoint.sh apac   About an hour ago   Up About an hour    0.0.0.0:8080-&gt;80/tcp   some-wordpress
11ddc1271814        mysql:latest        &#34;/entrypoint.sh mysq   About an hour ago   Up About an hour    3306/tcp               some-mysql
</code></pre><p>Om bijvoorbeeld IN je MySQL-container te checken wat er in de database staat, kan je met <code>docker exec -ti</code> een shell opstarten en in die container commandos uitvoeren:</p><pre tabindex=0><code>$ docker exec -ti some-mysql bash

root@11ddc1271814:/# mysql -u root -p
Enter password: p4ssw0rd
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 15
Server version: 5.6.24 MySQL Community Server (GPL)

Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.

mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| wordpress          |
+--------------------+
4 rows in set (0.00 sec)

mysql&gt; use wordpress;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql&gt; show tables;
+-----------------------+
| Tables_in_wordpress   |
+-----------------------+
| wp_commentmeta        |
| wp_comments           |
| wp_links              |
| wp_options            |
| wp_postmeta           |
| wp_posts              |
| wp_term_relationships |
| wp_term_taxonomy      |
| wp_terms              |
| wp_usermeta           |
| wp_users              |
+-----------------------+
11 rows in set (0.00 sec)

mysql&gt; exit
Bye
root@11ddc1271814:/# exit
</code></pre><h3 id=opruimen>Opruimen<a hidden class=anchor aria-hidden=true href=#opruimen>#</a></h3><p>Het commando <code>docker kill</code> is minder netjes dan <code>docker stop</code>, maar sneller als je toch besloten hebt de containers te verwijderen.</p><pre tabindex=0><code>$ docker kill 5c2537c15ba9 11ddc1271814
5c2537c15ba9
11ddc1271814

$ docker rm 5c2537c15ba9 11ddc1271814
5c2537c15ba9
11ddc1271814

$ docker ps
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
</code></pre><h2 id=met-docker-compose>&ldquo;Met docker-compose&rdquo;<a hidden class=anchor aria-hidden=true href=#met-docker-compose>#</a></h2><p>Nu doen we hetzelfde, maar met behulp van <em>docker-compose</em>.</p><h3 id=bestand-docker-composeyml>Bestand docker-compose.yml<a hidden class=anchor aria-hidden=true href=#bestand-docker-composeyml>#</a></h3><p>De waardes die je hierboven op de command-line hebt gegeven, kan je in <code>docker-compose.yml</code> combineren. Een YAML-bestand, dat er dan als volgt uit komt te zien:</p><pre tabindex=0><code>db:
  image: mysql:latest
  environment:
    - MYSQL_ROOT_PASSWORD=p4ssw0rd

wordpress:
  image: wordpress:latest
  links:
    - db:mysql
  ports:
    - &#34;8080:80&#34;
</code></pre><p>Start de stack in detached mode:</p><pre tabindex=0><code>$ docker-compose up -d
Creating wordpressmysql_db_1...
Creating wordpressmysql_wordpress_1...
</code></pre><h3 id=onder-de-motorkap-2>Onder de motorkap [2]<a hidden class=anchor aria-hidden=true href=#onder-de-motorkap-2>#</a></h3><p>Wat draait er nu?</p><pre tabindex=0><code>$ docker ps
CONTAINER ID        IMAGE               COMMAND                CREATED          STATUS              PORTS                  NAMES
fe9eead88a32        wordpress:latest    &#34;/entrypoint.sh apac   3 minutes ago    Up 3 minutes        0.0.0.0:8080-&gt;80/tcp   wordpressmysql_wordpress_1
6a2392af4d87        mysql:latest        &#34;/entrypoint.sh mysq   3 minutes ago    Up 3 minutes        3306/tcp               wordpressmysql_db_1

$ docker-compose ps
           Name                         Command               State          Ports
------------------------------------------------------------------------------------------
wordpressmysql_db_1          /entrypoint.sh mysqld            Up      3306/tcp
wordpressmysql_wordpress_1   /entrypoint.sh apache2-for ...   Up      0.0.0.0:8080-&gt;80/tcp
</code></pre><p>WordPress weer opzetten middels de hierboven genoemde link naar &ldquo;localhost&rdquo;.</p><p>En na ge- / misbruik weer alles netjes achterlaten:</p><pre tabindex=0><code>$ docker-compose kill
Killing wordpressmysql_wordpress_1...
Killing wordpressmysql_db_1...

$ docker-compose rm --force
Going to remove wordpressmysql_wordpress_1, wordpressmysql_db_1
Removing wordpressmysql_db_1...
Removing wordpressmysql_wordpress_1...
</code></pre><h2 id=data-volume-container>Data volume container<a hidden class=anchor aria-hidden=true href=#data-volume-container>#</a></h2><p>De data die door WordPress wordt gegenereerd (accounts, posts, etc.) kan worden opgeslagen buiten de MySQL-container in een zgn. <em>data volume container</em>. Die kan je op de CLI zo aanmaken:</p><p><code>$ docker run -v /var/lib/mysql --name=dbdata -d mysql /bin/true</code></p><p>De container is op basis van het MySQL-image, want die hebben we immers al binnen.<br>Een data volume container hoeft niet &ldquo;up&rdquo; te zijn om gebruikt te kunnen worden. Je ziet &rsquo;m dan ook alleen met het <code>docker ps -a</code> command:</p><pre tabindex=0><code>$ docker ps -a
CONTAINER ID        IMAGE               COMMAND                CREATED             STATUS                     PORTS               NAMES
c2aa204baf71        mysql:latest        &#34;/entrypoint.sh /bin   4 minutes ago       Exited (0) 4 minutes ago                       dbdata
</code></pre><p>Om dit met docker-compose te doen, voegen we deze container toe aan de YAML-configuratie.<br>Het bestand ziet er dan zo uit:</p><pre tabindex=0><code>dbdata:
  image: mysql
  volumes:
    - /var/lib/mysql
  command:
    - /bin/true

db:
  image: mysql
  volumes_from:
    - dbdata
  environment:
    - MYSQL_ROOT_PASSWORD=p4ssw0rd

wordpress:
  image: wordpress
  links:
    - db:mysql
  ports:
    - &#34;8080:80&#34;
</code></pre><p>Start weer een nieuwe stack met <code>docker-compose up -d</code> en controleer wat er draait:</p><pre tabindex=0><code>$ docker-compose ps
           Name                         Command               State           Ports
-------------------------------------------------------------------------------------------
wordpressmysql_db_1          /entrypoint.sh mysqld            Up       3306/tcp
wordpressmysql_dbdata_1      /entrypoint.sh /bin/true         Exit 0
wordpressmysql_wordpress_1   /entrypoint.sh apache2-for ...   Up       0.0.0.0:8080-&gt;80/tcp
</code></pre><p>Het bewijs dat beide containers dezelfde &ldquo;layer&rdquo; gebruiken voor /var/lib/mysql kan geleverd worden middels <code>docker inspect</code>:</p><pre tabindex=0><code>$ docker inspect dbdata | grep &#34;var/lib/mysql&#34; | grep vfs
        &#34;/mnt/sda1/var/lib/docker/vfs/dir/9acd80fd069e82a89ac04a9141cc518ce8ee176bd7e4cc92c972dd3df50dffcc&#34;

$ docker inspect wordpressmysql_db_1 | grep &#34;var/lib/mysql&#34; | grep vfs
        &#34;/mnt/sda1/var/lib/docker/vfs/dir/9acd80fd069e82a89ac04a9141cc518ce8ee176bd7e4cc92c972dd3df50dffcc&#34;
</code></pre><p>In boot2docker zie je dat als volgt - in die directory staat de database-data:</p><pre tabindex=0><code>docker@boot2docker:~$ sudo ls -altrF /mnt/sda1/var/lib/docker/vfs/dir/9acd80fd069e82a89ac04a9141cc518ce8ee176bd7e4cc92c972dd3df50dffcc/
total 176164
drwx------    2 999      999           4096 May 14 10:59 performance_schema/
drwx------    2 999      999           4096 May 14 10:59 mysql/
-rw-rw----    1 999      999       50331648 May 14 10:59 ib_logfile1
-rw-rw----    1 999      999             56 May 14 10:59 auto.cnf
drwx------    2 999      999           4096 May 14 11:02 wordpress/
drwx------  126 root     root         16384 May 14 11:07 ../
drwxr-xr-x    5 999      999           4096 May 14 11:07 ./
-rw-rw----    1 999      999       79691776 May 14 11:07 ibdata1
-rw-rw----    1 999      999       50331648 May 14 11:07 ib_logfile0
</code></pre><h3 id=backup-en-restore>Backup en restore<a hidden class=anchor aria-hidden=true href=#backup-en-restore>#</a></h3><p>Eén manier van backuppen van de database is de volgende:</p><pre tabindex=0><code>$ docker exec -ti wordpressmysql_db_1 bash -c \
 &#39;mysqldump --user=root --password=&#34;$MYSQL_ROOT_PASSWORD&#34; --all-databases&#39; \
  &gt; MySQL_full_backUp.sql
</code></pre><p>Restoren kan middels volume-sharing en een gelinkte container (&ldquo;db&rdquo; in het onderstaande geval):</p><pre tabindex=0><code>$ docker run -ti --rm -v $(pwd):/tmp --link wordpressmysql_db_1:db mysql bash

root@b2252da7520e:/# cd /tmp/
root@b2252da7520e:/tmp# ls -al

...

-rw-r--r--  1 1000 staff   1075329 May 18 14:36 MySQL_full_backUp.sql

...

root@b2252da7520e:/tmp# mysql -u root -p -h $DB_PORT_3306_TCP_ADDR
Enter password:

mysql&gt; source MySQL_full_backUp.sql
</code></pre><p>Referentie: YouTube - <a href="https://www.youtube.com/watch?v=2ZX3F-aFOxQ">Docker Tutorial: Backing Up and Restoring MySQL and WordPress in Docker</a></p><p><em>That&rsquo;s all Folks!</em></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://examplesite.com/tags/docker/>docker</a></li><li><a href=https://examplesite.com/tags/dutch/>dutch</a></li><li><a href=https://examplesite.com/tags/meetup/>meetup</a></li></ul><nav class=paginav><a class=prev href=https://examplesite.com/post/meetup2016/><span class=title>« Prev</span><br><span>Workshop: Python en Django in Docker</span></a>
<a class=next href=https://examplesite.com/post/post-title/><span class=title>Next »</span><br><span>Apple - Gramps Added to the Family</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Hands-on: WordPress en MySQL op Docker on twitter" href="https://twitter.com/intent/tweet/?text=Hands-on%3a%20WordPress%20en%20MySQL%20op%20Docker&url=https%3a%2f%2fexamplesite.com%2fpost%2fmeetup2015%2f&hashtags=docker%2cdutch%2cmeetup"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Hands-on: WordPress en MySQL op Docker on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fexamplesite.com%2fpost%2fmeetup2015%2f&title=Hands-on%3a%20WordPress%20en%20MySQL%20op%20Docker&summary=Hands-on%3a%20WordPress%20en%20MySQL%20op%20Docker&source=https%3a%2f%2fexamplesite.com%2fpost%2fmeetup2015%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Hands-on: WordPress en MySQL op Docker on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fexamplesite.com%2fpost%2fmeetup2015%2f&title=Hands-on%3a%20WordPress%20en%20MySQL%20op%20Docker"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Hands-on: WordPress en MySQL op Docker on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fexamplesite.com%2fpost%2fmeetup2015%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Hands-on: WordPress en MySQL op Docker on whatsapp" href="https://api.whatsapp.com/send?text=Hands-on%3a%20WordPress%20en%20MySQL%20op%20Docker%20-%20https%3a%2f%2fexamplesite.com%2fpost%2fmeetup2015%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Hands-on: WordPress en MySQL op Docker on telegram" href="https://telegram.me/share/url?text=Hands-on%3a%20WordPress%20en%20MySQL%20op%20Docker&url=https%3a%2f%2fexamplesite.com%2fpost%2fmeetup2015%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://examplesite.com/>ExampleSite</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>